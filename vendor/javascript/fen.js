import{pos2key as e,invRanks as t}from"./util.js";import{files as r}from"./types.js";const o="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR";const n={p:"pawn",r:"rook",n:"knight",b:"bishop",q:"queen",k:"king"};const p={pawn:"p",rook:"r",knight:"n",bishop:"b",queen:"q",king:"k"};function read(t){t==="start"&&(t=o);const r=new Map;let p=7,s=0;for(const o of t)switch(o){case" ":case"[":return r;case"/":--p;if(p<0)return r;s=0;break;case"~":{const t=r.get(e([s-1,p]));t&&(t.promoted=true);break}default:{const t=o.charCodeAt(0);if(t<57)s+=t-48;else{const t=o.toLowerCase();r.set(e([s,p]),{role:n[t],color:o===t?"black":"white"});++s}}}return r}function write(e){return t.map((t=>r.map((r=>{const o=e.get(r+t);if(o){let e=p[o.role];o.color==="white"&&(e=e.toUpperCase());o.promoted&&(e+="~");return e}return"1"})).join(""))).join("/").replace(/1{2,}/g,(e=>e.length.toString()))}export{o as initial,read,write};
//# sourceMappingURL=fen.js.map
